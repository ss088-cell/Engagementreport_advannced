<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script>
    function fetchReport() {
      const appSelect = document.getElementById("appSelect");
      const appName = appSelect.value;
      if (!appName) {
        alert("Please select an application.");
        return;
      }

      google.script.run.withSuccessHandler(function(response) {
        if (response.success) {
          alert("Report generated successfully! View it here: " + response.sheetUrl);
        } else {
          alert("Error: " + response.message);
        }
      }).importDefectDojoReport(appName);
    }

    function loadApplications() {
      google.script.run.withSuccessHandler(function(apps) {
        const appSelect = document.getElementById("appSelect");
        apps.forEach(function(app) {
          const option = document.createElement("option");
          option.value = app;
          option.text = app;
          appSelect.appendChild(option);
        });
      }).getApplications();
    }
  </script>
</head>
<body onload="loadApplications()">
  <h1>Defect Dojo Report Generator</h1>
  <label for="appSelect">Select Application:</label>
  <select id="appSelect">
    <option value="">--Select Application--</option>
  </select>
  <button onclick="fetchReport()">Generate Report</button>
</body>
</html>
